# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIRIII
SELECT
  c9,
  row_number() OVER (PARTITION BY c2, c9) AS row_number,
  count(c3) OVER (PARTITION BY c2) AS count_c3,
  avg(c3) OVER (PARTITION BY c2) AS avg_c3_by_c2,
  sum(c3) OVER (PARTITION BY c2) AS sum_c3_by_c2,
  max(c3) OVER (PARTITION BY c2) AS max_c3_by_c2,
  min(c3) OVER (PARTITION BY c2) AS min_c3_by_c2
FROM aggregate_test_100_by_sql
ORDER BY c9;
----
28774375 1 23 1.260869565217 29 123 -117
63044568 1 22 8.363636363636 184 122 -117
141047417 1 14 -13.857142857143 -194 118 -101
141680161 1 22 8.363636363636 184 122 -117
145294611 1 22 8.363636363636 184 122 -117
225513085 1 22 16.681818181818 367 125 -99
243203849 1 19 20.789473684211 395 123 -101
326151275 1 23 1.260869565217 29 123 -117
431948861 1 19 20.789473684211 395 123 -101
466439833 1 23 1.260869565217 29 123 -117
473294098 1 22 16.681818181818 367 125 -99
520189543 1 22 16.681818181818 367 125 -99
538589788 1 23 1.260869565217 29 123 -117
557517119 1 23 1.260869565217 29 123 -117
559847112 1 19 20.789473684211 395 123 -101
598822671 1 22 8.363636363636 184 122 -117
662099130 1 14 -13.857142857143 -194 118 -101
754775609 1 19 20.789473684211 395 123 -101
774637006 1 22 16.681818181818 367 125 -99
811650497 1 23 1.260869565217 29 123 -117
879082834 1 22 16.681818181818 367 125 -99
933879086 1 23 1.260869565217 29 123 -117
974297360 1 14 -13.857142857143 -194 118 -101
1000948272 1 22 8.363636363636 184 122 -117
1013876852 1 14 -13.857142857143 -194 118 -101
1088543984 1 19 20.789473684211 395 123 -101
1098639440 1 22 8.363636363636 184 122 -117
1157161427 1 22 8.363636363636 184 122 -117
1229567292 1 14 -13.857142857143 -194 118 -101
1243785310 1 23 1.260869565217 29 123 -117
1289293657 1 22 8.363636363636 184 122 -117
1362369177 1 19 20.789473684211 395 123 -101
1365198901 1 14 -13.857142857143 -194 118 -101
1454057357 1 22 16.681818181818 367 125 -99
1491205016 1 22 8.363636363636 184 122 -117
1534194097 1 23 1.260869565217 29 123 -117
1538863055 1 19 20.789473684211 395 123 -101
1787652631 1 23 1.260869565217 29 123 -117
1824517658 1 19 20.789473684211 395 123 -101
1842680163 1 22 16.681818181818 367 125 -99
1865307672 1 23 1.260869565217 29 123 -117
1995343206 1 19 20.789473684211 395 123 -101
2013662838 1 22 8.363636363636 184 122 -117
2042457019 1 23 1.260869565217 29 123 -117
2093538928 1 19 20.789473684211 395 123 -101
2125812933 1 22 16.681818181818 367 125 -99
2214035726 1 19 20.789473684211 395 123 -101
2293105904 1 22 8.363636363636 184 122 -117
2306130875 1 23 1.260869565217 29 123 -117
2307004493 1 14 -13.857142857143 -194 118 -101
2424630722 1 14 -13.857142857143 -194 118 -101
2496054700 1 14 -13.857142857143 -194 118 -101
2502326480 1 23 1.260869565217 29 123 -117
2525744318 1 22 8.363636363636 184 122 -117
2592330556 1 19 20.789473684211 395 123 -101
2610290479 1 22 16.681818181818 367 125 -99
2669374863 1 22 16.681818181818 367 125 -99
2705709344 1 22 8.363636363636 184 122 -117
2712615025 1 22 16.681818181818 367 125 -99
2778168728 1 23 1.260869565217 29 123 -117
2818832252 1 23 1.260869565217 29 123 -117
2830981072 1 22 16.681818181818 367 125 -99
2844041986 1 22 8.363636363636 184 122 -117
2861376515 1 22 16.681818181818 367 125 -99
2861911482 1 14 -13.857142857143 -194 118 -101
2939920218 1 22 8.363636363636 184 122 -117
3023531799 1 23 1.260869565217 29 123 -117
3105312559 1 19 20.789473684211 395 123 -101
3126475872 1 23 1.260869565217 29 123 -117
3188005828 1 22 8.363636363636 184 122 -117
3198969145 1 23 1.260869565217 29 123 -117
3275293996 1 22 16.681818181818 367 125 -99
3276123488 1 22 16.681818181818 367 125 -99
3314983189 1 22 8.363636363636 184 122 -117
3342719438 1 14 -13.857142857143 -194 118 -101
3373581039 1 14 -13.857142857143 -194 118 -101
3398507249 1 22 8.363636363636 184 122 -117
3455216719 1 22 8.363636363636 184 122 -117
3457053821 1 14 -13.857142857143 -194 118 -101
3473924576 1 19 20.789473684211 395 123 -101
3521368277 1 23 1.260869565217 29 123 -117
3542840110 1 22 16.681818181818 367 125 -99
3566741189 1 23 1.260869565217 29 123 -117
3570297463 1 23 1.260869565217 29 123 -117
3577318119 1 19 20.789473684211 395 123 -101
3593959807 1 23 1.260869565217 29 123 -117
3625286410 1 22 16.681818181818 367 125 -99
3717551163 1 22 8.363636363636 184 122 -117
3759340273 1 19 20.789473684211 395 123 -101
3766999078 1 22 16.681818181818 367 125 -99
3862393166 1 19 20.789473684211 395 123 -101
3959216334 1 19 20.789473684211 395 123 -101
3998790955 1 19 20.789473684211 395 123 -101
4015442341 1 22 16.681818181818 367 125 -99
4061635107 1 22 8.363636363636 184 122 -117
4076864659 1 22 16.681818181818 367 125 -99
4144173353 1 22 8.363636363636 184 122 -117
4216440507 1 22 16.681818181818 367 125 -99
4229654142 1 22 16.681818181818 367 125 -99
4268716378 1 14 -13.857142857143 -194 118 -101
