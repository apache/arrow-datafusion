# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIIIIIIII
SELECT
  c9,
  row_number() OVER (ORDER BY c9) row_num,
  lead(c9) OVER (ORDER BY c9) lead_c9,
  lag(c9) OVER (ORDER BY c9) lag_c9,
  first_value(c9) OVER (ORDER BY c9) first_c9,
  first_value(c9) OVER (ORDER BY c9 DESC) first_c9_desc,
  last_value(c9) OVER (ORDER BY c9) last_c9,
  last_value(c9) OVER (ORDER BY c9 DESC) last_c9_desc,
  nth_value(c9, 2) OVER (ORDER BY c9) second_c9,
  nth_value(c9, 2) OVER (ORDER BY c9 DESC) second_c9_desc
FROM aggregate_test_100_by_sql
ORDER BY c9;
----
28774375 1 63044568 NULL 28774375 4268716378 28774375 28774375 NULL 4229654142
63044568 2 141047417 28774375 28774375 4268716378 63044568 63044568 63044568 4229654142
141047417 3 141680161 63044568 28774375 4268716378 141047417 141047417 63044568 4229654142
141680161 4 145294611 141047417 28774375 4268716378 141680161 141680161 63044568 4229654142
145294611 5 225513085 141680161 28774375 4268716378 145294611 145294611 63044568 4229654142
225513085 6 243203849 145294611 28774375 4268716378 225513085 225513085 63044568 4229654142
243203849 7 326151275 225513085 28774375 4268716378 243203849 243203849 63044568 4229654142
326151275 8 431948861 243203849 28774375 4268716378 326151275 326151275 63044568 4229654142
431948861 9 466439833 326151275 28774375 4268716378 431948861 431948861 63044568 4229654142
466439833 10 473294098 431948861 28774375 4268716378 466439833 466439833 63044568 4229654142
473294098 11 520189543 466439833 28774375 4268716378 473294098 473294098 63044568 4229654142
520189543 12 538589788 473294098 28774375 4268716378 520189543 520189543 63044568 4229654142
538589788 13 557517119 520189543 28774375 4268716378 538589788 538589788 63044568 4229654142
557517119 14 559847112 538589788 28774375 4268716378 557517119 557517119 63044568 4229654142
559847112 15 598822671 557517119 28774375 4268716378 559847112 559847112 63044568 4229654142
598822671 16 662099130 559847112 28774375 4268716378 598822671 598822671 63044568 4229654142
662099130 17 754775609 598822671 28774375 4268716378 662099130 662099130 63044568 4229654142
754775609 18 774637006 662099130 28774375 4268716378 754775609 754775609 63044568 4229654142
774637006 19 811650497 754775609 28774375 4268716378 774637006 774637006 63044568 4229654142
811650497 20 879082834 774637006 28774375 4268716378 811650497 811650497 63044568 4229654142
879082834 21 933879086 811650497 28774375 4268716378 879082834 879082834 63044568 4229654142
933879086 22 974297360 879082834 28774375 4268716378 933879086 933879086 63044568 4229654142
974297360 23 1000948272 933879086 28774375 4268716378 974297360 974297360 63044568 4229654142
1000948272 24 1013876852 974297360 28774375 4268716378 1000948272 1000948272 63044568 4229654142
1013876852 25 1088543984 1000948272 28774375 4268716378 1013876852 1013876852 63044568 4229654142
1088543984 26 1098639440 1013876852 28774375 4268716378 1088543984 1088543984 63044568 4229654142
1098639440 27 1157161427 1088543984 28774375 4268716378 1098639440 1098639440 63044568 4229654142
1157161427 28 1229567292 1098639440 28774375 4268716378 1157161427 1157161427 63044568 4229654142
1229567292 29 1243785310 1157161427 28774375 4268716378 1229567292 1229567292 63044568 4229654142
1243785310 30 1289293657 1229567292 28774375 4268716378 1243785310 1243785310 63044568 4229654142
1289293657 31 1362369177 1243785310 28774375 4268716378 1289293657 1289293657 63044568 4229654142
1362369177 32 1365198901 1289293657 28774375 4268716378 1362369177 1362369177 63044568 4229654142
1365198901 33 1454057357 1362369177 28774375 4268716378 1365198901 1365198901 63044568 4229654142
1454057357 34 1491205016 1365198901 28774375 4268716378 1454057357 1454057357 63044568 4229654142
1491205016 35 1534194097 1454057357 28774375 4268716378 1491205016 1491205016 63044568 4229654142
1534194097 36 1538863055 1491205016 28774375 4268716378 1534194097 1534194097 63044568 4229654142
1538863055 37 1787652631 1534194097 28774375 4268716378 1538863055 1538863055 63044568 4229654142
1787652631 38 1824517658 1538863055 28774375 4268716378 1787652631 1787652631 63044568 4229654142
1824517658 39 1842680163 1787652631 28774375 4268716378 1824517658 1824517658 63044568 4229654142
1842680163 40 1865307672 1824517658 28774375 4268716378 1842680163 1842680163 63044568 4229654142
1865307672 41 1995343206 1842680163 28774375 4268716378 1865307672 1865307672 63044568 4229654142
1995343206 42 2013662838 1865307672 28774375 4268716378 1995343206 1995343206 63044568 4229654142
2013662838 43 2042457019 1995343206 28774375 4268716378 2013662838 2013662838 63044568 4229654142
2042457019 44 2093538928 2013662838 28774375 4268716378 2042457019 2042457019 63044568 4229654142
2093538928 45 2125812933 2042457019 28774375 4268716378 2093538928 2093538928 63044568 4229654142
2125812933 46 2214035726 2093538928 28774375 4268716378 2125812933 2125812933 63044568 4229654142
2214035726 47 2293105904 2125812933 28774375 4268716378 2214035726 2214035726 63044568 4229654142
2293105904 48 2306130875 2214035726 28774375 4268716378 2293105904 2293105904 63044568 4229654142
2306130875 49 2307004493 2293105904 28774375 4268716378 2306130875 2306130875 63044568 4229654142
2307004493 50 2424630722 2306130875 28774375 4268716378 2307004493 2307004493 63044568 4229654142
2424630722 51 2496054700 2307004493 28774375 4268716378 2424630722 2424630722 63044568 4229654142
2496054700 52 2502326480 2424630722 28774375 4268716378 2496054700 2496054700 63044568 4229654142
2502326480 53 2525744318 2496054700 28774375 4268716378 2502326480 2502326480 63044568 4229654142
2525744318 54 2592330556 2502326480 28774375 4268716378 2525744318 2525744318 63044568 4229654142
2592330556 55 2610290479 2525744318 28774375 4268716378 2592330556 2592330556 63044568 4229654142
2610290479 56 2669374863 2592330556 28774375 4268716378 2610290479 2610290479 63044568 4229654142
2669374863 57 2705709344 2610290479 28774375 4268716378 2669374863 2669374863 63044568 4229654142
2705709344 58 2712615025 2669374863 28774375 4268716378 2705709344 2705709344 63044568 4229654142
2712615025 59 2778168728 2705709344 28774375 4268716378 2712615025 2712615025 63044568 4229654142
2778168728 60 2818832252 2712615025 28774375 4268716378 2778168728 2778168728 63044568 4229654142
2818832252 61 2830981072 2778168728 28774375 4268716378 2818832252 2818832252 63044568 4229654142
2830981072 62 2844041986 2818832252 28774375 4268716378 2830981072 2830981072 63044568 4229654142
2844041986 63 2861376515 2830981072 28774375 4268716378 2844041986 2844041986 63044568 4229654142
2861376515 64 2861911482 2844041986 28774375 4268716378 2861376515 2861376515 63044568 4229654142
2861911482 65 2939920218 2861376515 28774375 4268716378 2861911482 2861911482 63044568 4229654142
2939920218 66 3023531799 2861911482 28774375 4268716378 2939920218 2939920218 63044568 4229654142
3023531799 67 3105312559 2939920218 28774375 4268716378 3023531799 3023531799 63044568 4229654142
3105312559 68 3126475872 3023531799 28774375 4268716378 3105312559 3105312559 63044568 4229654142
3126475872 69 3188005828 3105312559 28774375 4268716378 3126475872 3126475872 63044568 4229654142
3188005828 70 3198969145 3126475872 28774375 4268716378 3188005828 3188005828 63044568 4229654142
3198969145 71 3275293996 3188005828 28774375 4268716378 3198969145 3198969145 63044568 4229654142
3275293996 72 3276123488 3198969145 28774375 4268716378 3275293996 3275293996 63044568 4229654142
3276123488 73 3314983189 3275293996 28774375 4268716378 3276123488 3276123488 63044568 4229654142
3314983189 74 3342719438 3276123488 28774375 4268716378 3314983189 3314983189 63044568 4229654142
3342719438 75 3373581039 3314983189 28774375 4268716378 3342719438 3342719438 63044568 4229654142
3373581039 76 3398507249 3342719438 28774375 4268716378 3373581039 3373581039 63044568 4229654142
3398507249 77 3455216719 3373581039 28774375 4268716378 3398507249 3398507249 63044568 4229654142
3455216719 78 3457053821 3398507249 28774375 4268716378 3455216719 3455216719 63044568 4229654142
3457053821 79 3473924576 3455216719 28774375 4268716378 3457053821 3457053821 63044568 4229654142
3473924576 80 3521368277 3457053821 28774375 4268716378 3473924576 3473924576 63044568 4229654142
3521368277 81 3542840110 3473924576 28774375 4268716378 3521368277 3521368277 63044568 4229654142
3542840110 82 3566741189 3521368277 28774375 4268716378 3542840110 3542840110 63044568 4229654142
3566741189 83 3570297463 3542840110 28774375 4268716378 3566741189 3566741189 63044568 4229654142
3570297463 84 3577318119 3566741189 28774375 4268716378 3570297463 3570297463 63044568 4229654142
3577318119 85 3593959807 3570297463 28774375 4268716378 3577318119 3577318119 63044568 4229654142
3593959807 86 3625286410 3577318119 28774375 4268716378 3593959807 3593959807 63044568 4229654142
3625286410 87 3717551163 3593959807 28774375 4268716378 3625286410 3625286410 63044568 4229654142
3717551163 88 3759340273 3625286410 28774375 4268716378 3717551163 3717551163 63044568 4229654142
3759340273 89 3766999078 3717551163 28774375 4268716378 3759340273 3759340273 63044568 4229654142
3766999078 90 3862393166 3759340273 28774375 4268716378 3766999078 3766999078 63044568 4229654142
3862393166 91 3959216334 3766999078 28774375 4268716378 3862393166 3862393166 63044568 4229654142
3959216334 92 3998790955 3862393166 28774375 4268716378 3959216334 3959216334 63044568 4229654142
3998790955 93 4015442341 3959216334 28774375 4268716378 3998790955 3998790955 63044568 4229654142
4015442341 94 4061635107 3998790955 28774375 4268716378 4015442341 4015442341 63044568 4229654142
4061635107 95 4076864659 4015442341 28774375 4268716378 4061635107 4061635107 63044568 4229654142
4076864659 96 4144173353 4061635107 28774375 4268716378 4076864659 4076864659 63044568 4229654142
4144173353 97 4216440507 4076864659 28774375 4268716378 4144173353 4144173353 63044568 4229654142
4216440507 98 4229654142 4144173353 28774375 4268716378 4216440507 4216440507 63044568 4229654142
4229654142 99 4268716378 4216440507 28774375 4268716378 4229654142 4229654142 63044568 4229654142
4268716378 100 NULL 4229654142 28774375 4268716378 4268716378 4268716378 63044568 NULL
