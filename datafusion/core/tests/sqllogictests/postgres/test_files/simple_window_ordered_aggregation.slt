# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIRIII
SELECT
  c9,
  row_number() OVER (ORDER BY c2, c9) AS row_number,
  count(c3) OVER (ORDER BY c9) AS count_c3,
  avg(c3) OVER (ORDER BY c2) AS avg_c3_by_c2,
  sum(c3) OVER (ORDER BY c2) AS sum_c3_by_c2,
  max(c3) OVER (ORDER BY c2) AS max_c3_by_c2,
  min(c3) OVER (ORDER BY c2) AS min_c3_by_c2
FROM aggregate_test_100_by_sql
ORDER BY row_number;
----
225513085 1 6 16.681818181818 367 125 -99
473294098 2 11 16.681818181818 367 125 -99
520189543 3 12 16.681818181818 367 125 -99
774637006 4 19 16.681818181818 367 125 -99
879082834 5 21 16.681818181818 367 125 -99
1454057357 6 34 16.681818181818 367 125 -99
1842680163 7 40 16.681818181818 367 125 -99
2125812933 8 46 16.681818181818 367 125 -99
2610290479 9 56 16.681818181818 367 125 -99
2669374863 10 57 16.681818181818 367 125 -99
2712615025 11 59 16.681818181818 367 125 -99
2830981072 12 62 16.681818181818 367 125 -99
2861376515 13 64 16.681818181818 367 125 -99
3275293996 14 72 16.681818181818 367 125 -99
3276123488 15 73 16.681818181818 367 125 -99
3542840110 16 82 16.681818181818 367 125 -99
3625286410 17 87 16.681818181818 367 125 -99
3766999078 18 90 16.681818181818 367 125 -99
4015442341 19 94 16.681818181818 367 125 -99
4076864659 20 96 16.681818181818 367 125 -99
4216440507 21 98 16.681818181818 367 125 -99
4229654142 22 99 16.681818181818 367 125 -99
63044568 23 2 12.522727272727 551 125 -117
141680161 24 4 12.522727272727 551 125 -117
145294611 25 5 12.522727272727 551 125 -117
598822671 26 16 12.522727272727 551 125 -117
1000948272 27 24 12.522727272727 551 125 -117
1098639440 28 27 12.522727272727 551 125 -117
1157161427 29 28 12.522727272727 551 125 -117
1289293657 30 31 12.522727272727 551 125 -117
1491205016 31 35 12.522727272727 551 125 -117
2013662838 32 43 12.522727272727 551 125 -117
2293105904 33 48 12.522727272727 551 125 -117
2525744318 34 54 12.522727272727 551 125 -117
2705709344 35 58 12.522727272727 551 125 -117
2844041986 36 63 12.522727272727 551 125 -117
2939920218 37 66 12.522727272727 551 125 -117
3188005828 38 70 12.522727272727 551 125 -117
3314983189 39 74 12.522727272727 551 125 -117
3398507249 40 77 12.522727272727 551 125 -117
3455216719 41 78 12.522727272727 551 125 -117
3717551163 42 88 12.522727272727 551 125 -117
4061635107 43 95 12.522727272727 551 125 -117
4144173353 44 97 12.522727272727 551 125 -117
243203849 45 7 15.015873015873 946 125 -117
431948861 46 9 15.015873015873 946 125 -117
559847112 47 15 15.015873015873 946 125 -117
754775609 48 18 15.015873015873 946 125 -117
1088543984 49 26 15.015873015873 946 125 -117
1362369177 50 32 15.015873015873 946 125 -117
1538863055 51 37 15.015873015873 946 125 -117
1824517658 52 39 15.015873015873 946 125 -117
1995343206 53 42 15.015873015873 946 125 -117
2093538928 54 45 15.015873015873 946 125 -117
2214035726 55 47 15.015873015873 946 125 -117
2592330556 56 55 15.015873015873 946 125 -117
3105312559 57 68 15.015873015873 946 125 -117
3473924576 58 80 15.015873015873 946 125 -117
3577318119 59 85 15.015873015873 946 125 -117
3759340273 60 89 15.015873015873 946 125 -117
3862393166 61 91 15.015873015873 946 125 -117
3959216334 62 92 15.015873015873 946 125 -117
3998790955 63 93 15.015873015873 946 125 -117
28774375 64 1 11.337209302326 975 125 -117
326151275 65 8 11.337209302326 975 125 -117
466439833 66 10 11.337209302326 975 125 -117
538589788 67 13 11.337209302326 975 125 -117
557517119 68 14 11.337209302326 975 125 -117
811650497 69 20 11.337209302326 975 125 -117
933879086 70 22 11.337209302326 975 125 -117
1243785310 71 30 11.337209302326 975 125 -117
1534194097 72 36 11.337209302326 975 125 -117
1787652631 73 38 11.337209302326 975 125 -117
1865307672 74 41 11.337209302326 975 125 -117
2042457019 75 44 11.337209302326 975 125 -117
2306130875 76 49 11.337209302326 975 125 -117
2502326480 77 53 11.337209302326 975 125 -117
2778168728 78 60 11.337209302326 975 125 -117
2818832252 79 61 11.337209302326 975 125 -117
3023531799 80 67 11.337209302326 975 125 -117
3126475872 81 69 11.337209302326 975 125 -117
3198969145 82 71 11.337209302326 975 125 -117
3521368277 83 81 11.337209302326 975 125 -117
3566741189 84 83 11.337209302326 975 125 -117
3570297463 85 84 11.337209302326 975 125 -117
3593959807 86 86 11.337209302326 975 125 -117
141047417 87 3 7.81 781 125 -117
662099130 88 17 7.81 781 125 -117
974297360 89 23 7.81 781 125 -117
1013876852 90 25 7.81 781 125 -117
1229567292 91 29 7.81 781 125 -117
1365198901 92 33 7.81 781 125 -117
2307004493 93 50 7.81 781 125 -117
2424630722 94 51 7.81 781 125 -117
2496054700 95 52 7.81 781 125 -117
2861911482 96 65 7.81 781 125 -117
3342719438 97 75 7.81 781 125 -117
3373581039 98 76 7.81 781 125 -117
3457053821 99 79 7.81 781 125 -117
4268716378 100 100 7.81 781 125 -117
