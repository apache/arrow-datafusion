# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIIIII
SELECT
  c8,
  LEAD(c8) OVER () next_c8,
  LEAD(c8, 10, 10) OVER() next_10_c8,
  LEAD(c8, 100, 10) OVER() next_out_of_bounds_c8,
  LAG(c8) OVER() prev_c8,
  LAG(c8, -2, 0) OVER() AS prev_2_c8,
  LAG(c8, -200, 10) OVER() AS prev_out_of_bounds_c8
FROM aggregate_test_100_by_sql
ORDER BY c8;
----
102 33715 48099 10 31648 28086 10
299 NULL 10 10 7781 0 10
363 17910 40566 10 48048 27744 10
417 18736 53000 10 45185 29458 10
794 44507 49283 10 3583 40622 10
829 33821 11872 10 61069 59663 10
832 53012 2684 10 40622 48483 10
1535 34970 48048 10 50842 2516 10
2516 57594 17910 10 34970 36599 10
2555 24770 34970 10 28086 53000 10
2684 47061 57751 10 12876 14722 10
2809 56980 3691 10 64517 27600 10
2986 35477 28086 10 12757 45185 10
3583 794 24022 10 35429 44507 10
3691 50009 35429 10 63353 5494 10
3975 59134 10 10 39363 30972 10
4168 24022 829 10 15573 49283 10
5382 12393 31648 10 24380 12757 10
5494 21119 794 10 50009 52046 10
7781 299 10 10 30972 0 10
9489 52286 32712 10 14337 34331 10
9832 20807 12393 10 34331 17835 10
11872 39363 10 10 57885 3975 10
12393 12757 102 10 5382 2986 10
12757 2986 33715 10 12393 35477 10
12876 2684 29527 10 45253 47061 10
13763 15573 53815 10 48483 4168 10
14337 9489 15777 10 43062 52286 10
14722 53815 54276 10 47061 61069 10
15573 4168 61069 10 13763 24022 10
15777 32712 18736 10 62167 24380 10
17835 57510 2986 10 20807 45465 10
17910 27744 34206 10 363 20421 10
18736 29458 39635 10 417 35106 10
20120 57885 10 10 54276 11872 10
20421 63353 23948 10 27744 3691 10
20807 17835 12757 10 9832 57510 10
21119 52046 44507 10 5494 40566 10
21463 48099 56980 10 43655 50842 10
23948 61637 13763 10 55620 35429 10
24022 49283 33821 10 4168 45253 10
24380 5382 35106 10 32712 12393 10
24770 53000 2516 10 2555 39635 10
27034 48048 21119 10 27600 363 10
27600 27034 5494 10 56980 48048 10
27744 20421 55620 10 17910 63353 10
28086 2555 1535 10 33715 24770 10
29458 35106 52569 10 18736 31648 10
29527 57751 30972 10 30296 42171 10
30296 29527 59134 10 59663 57751 10
30972 7781 10 10 59134 299 10
31648 102 21463 10 35106 33715 10
32712 24380 29458 10 15777 5382 10
33715 28086 50842 10 102 2555 10
33821 59663 39363 10 829 30296 10
34206 55620 53012 10 40566 23948 10
34331 9832 5382 10 52286 20807 10
34970 2516 363 10 1535 57594 10
35106 31648 43655 10 29458 102 10
35429 3583 4168 10 61637 794 10
35477 45185 2555 10 2986 417 10
36599 64517 20421 10 57594 2809 10
39363 3975 10 10 11872 59134 10
39635 52569 36599 10 53000 43655 10
40566 34206 832 10 52046 55620 10
40622 832 12876 10 44507 53012 10
42171 54276 299 10 57751 20120 10
43062 14337 62167 10 NULL 9489 10
43655 21463 2809 10 52569 48099 10
44507 40622 45253 10 794 832 10
45185 417 24770 10 35477 18736 10
45253 12876 30296 10 49283 2684 10
45465 62167 45185 10 57510 15777 10
47061 14722 42171 10 2684 53815 10
48048 363 52046 10 27034 17910 10
48099 50842 27600 10 21463 1535 10
48483 13763 14722 10 53012 15573 10
49283 45253 59663 10 24022 12876 10
50009 5494 3583 10 3691 21119 10
50842 1535 27034 10 48099 34970 10
52046 40566 40622 10 21119 34206 10
52286 34331 24380 10 9489 9832 10
52569 43655 64517 10 39635 21463 10
53000 39635 57594 10 24770 52569 10
53012 48483 47061 10 832 13763 10
53815 61069 20120 10 14722 829 10
54276 20120 10 10 42171 57885 10
55620 23948 48483 10 34206 61637 10
56980 27600 50009 10 2809 27034 10
57510 45465 35477 10 17835 62167 10
57594 36599 27744 10 2516 64517 10
57751 42171 7781 10 29527 54276 10
57885 11872 10 10 20120 39363 10
59134 30972 10 10 3975 7781 10
59663 30296 3975 10 33821 29527 10
61069 829 57885 10 53815 33821 10
61637 35429 15573 10 23948 3583 10
62167 15777 417 10 45465 32712 10
63353 3691 61637 10 20421 50009 10
64517 2809 63353 10 36599 56980 10
