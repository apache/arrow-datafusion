# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIIIIIIII
SELECT
  c9,
  row_number() OVER (PARTITION BY c2 ORDER BY c9) row_num,
  lead(c9) OVER (PARTITION BY c2 ORDER BY c9) lead_c9,
  lag(c9) OVER (PARTITION BY c2 ORDER BY c9) lag_c9,
  first_value(c9) OVER (PARTITION BY c2 ORDER BY c9) first_c9,
  first_value(c9) OVER (PARTITION BY c2 ORDER BY c9 DESC) first_c9_desc,
  last_value(c9) OVER (PARTITION BY c2 ORDER BY c9) last_c9,
  last_value(c9) OVER (PARTITION BY c2 ORDER BY c9 DESC) last_c9_desc,
  nth_value(c9, 2) OVER (PARTITION BY c2 ORDER BY c9) second_c9,
  nth_value(c9, 2) OVER (PARTITION BY c2 ORDER BY c9 DESC) second_c9_desc
FROM aggregate_test_100_by_sql
ORDER BY c9;
----
28774375 1 326151275 NULL 28774375 3593959807 28774375 28774375 NULL 3570297463
63044568 1 141680161 NULL 63044568 4144173353 63044568 63044568 NULL 4061635107
141047417 1 662099130 NULL 141047417 4268716378 141047417 141047417 NULL 3457053821
141680161 2 145294611 63044568 63044568 4144173353 141680161 141680161 141680161 4061635107
145294611 3 598822671 141680161 63044568 4144173353 145294611 145294611 141680161 4061635107
225513085 1 473294098 NULL 225513085 4229654142 225513085 225513085 NULL 4216440507
243203849 1 431948861 NULL 243203849 3998790955 243203849 243203849 NULL 3959216334
326151275 2 466439833 28774375 28774375 3593959807 326151275 326151275 326151275 3570297463
431948861 2 559847112 243203849 243203849 3998790955 431948861 431948861 431948861 3959216334
466439833 3 538589788 326151275 28774375 3593959807 466439833 466439833 326151275 3570297463
473294098 2 520189543 225513085 225513085 4229654142 473294098 473294098 473294098 4216440507
520189543 3 774637006 473294098 225513085 4229654142 520189543 520189543 473294098 4216440507
538589788 4 557517119 466439833 28774375 3593959807 538589788 538589788 326151275 3570297463
557517119 5 811650497 538589788 28774375 3593959807 557517119 557517119 326151275 3570297463
559847112 3 754775609 431948861 243203849 3998790955 559847112 559847112 431948861 3959216334
598822671 4 1000948272 145294611 63044568 4144173353 598822671 598822671 141680161 4061635107
662099130 2 974297360 141047417 141047417 4268716378 662099130 662099130 662099130 3457053821
754775609 4 1088543984 559847112 243203849 3998790955 754775609 754775609 431948861 3959216334
774637006 4 879082834 520189543 225513085 4229654142 774637006 774637006 473294098 4216440507
811650497 6 933879086 557517119 28774375 3593959807 811650497 811650497 326151275 3570297463
879082834 5 1454057357 774637006 225513085 4229654142 879082834 879082834 473294098 4216440507
933879086 7 1243785310 811650497 28774375 3593959807 933879086 933879086 326151275 3570297463
974297360 3 1013876852 662099130 141047417 4268716378 974297360 974297360 662099130 3457053821
1000948272 5 1098639440 598822671 63044568 4144173353 1000948272 1000948272 141680161 4061635107
1013876852 4 1229567292 974297360 141047417 4268716378 1013876852 1013876852 662099130 3457053821
1088543984 5 1362369177 754775609 243203849 3998790955 1088543984 1088543984 431948861 3959216334
1098639440 6 1157161427 1000948272 63044568 4144173353 1098639440 1098639440 141680161 4061635107
1157161427 7 1289293657 1098639440 63044568 4144173353 1157161427 1157161427 141680161 4061635107
1229567292 5 1365198901 1013876852 141047417 4268716378 1229567292 1229567292 662099130 3457053821
1243785310 8 1534194097 933879086 28774375 3593959807 1243785310 1243785310 326151275 3570297463
1289293657 8 1491205016 1157161427 63044568 4144173353 1289293657 1289293657 141680161 4061635107
1362369177 6 1538863055 1088543984 243203849 3998790955 1362369177 1362369177 431948861 3959216334
1365198901 6 2307004493 1229567292 141047417 4268716378 1365198901 1365198901 662099130 3457053821
1454057357 6 1842680163 879082834 225513085 4229654142 1454057357 1454057357 473294098 4216440507
1491205016 9 2013662838 1289293657 63044568 4144173353 1491205016 1491205016 141680161 4061635107
1534194097 9 1787652631 1243785310 28774375 3593959807 1534194097 1534194097 326151275 3570297463
1538863055 7 1824517658 1362369177 243203849 3998790955 1538863055 1538863055 431948861 3959216334
1787652631 10 1865307672 1534194097 28774375 3593959807 1787652631 1787652631 326151275 3570297463
1824517658 8 1995343206 1538863055 243203849 3998790955 1824517658 1824517658 431948861 3959216334
1842680163 7 2125812933 1454057357 225513085 4229654142 1842680163 1842680163 473294098 4216440507
1865307672 11 2042457019 1787652631 28774375 3593959807 1865307672 1865307672 326151275 3570297463
1995343206 9 2093538928 1824517658 243203849 3998790955 1995343206 1995343206 431948861 3959216334
2013662838 10 2293105904 1491205016 63044568 4144173353 2013662838 2013662838 141680161 4061635107
2042457019 12 2306130875 1865307672 28774375 3593959807 2042457019 2042457019 326151275 3570297463
2093538928 10 2214035726 1995343206 243203849 3998790955 2093538928 2093538928 431948861 3959216334
2125812933 8 2610290479 1842680163 225513085 4229654142 2125812933 2125812933 473294098 4216440507
2214035726 11 2592330556 2093538928 243203849 3998790955 2214035726 2214035726 431948861 3959216334
2293105904 11 2525744318 2013662838 63044568 4144173353 2293105904 2293105904 141680161 4061635107
2306130875 13 2502326480 2042457019 28774375 3593959807 2306130875 2306130875 326151275 3570297463
2307004493 7 2424630722 1365198901 141047417 4268716378 2307004493 2307004493 662099130 3457053821
2424630722 8 2496054700 2307004493 141047417 4268716378 2424630722 2424630722 662099130 3457053821
2496054700 9 2861911482 2424630722 141047417 4268716378 2496054700 2496054700 662099130 3457053821
2502326480 14 2778168728 2306130875 28774375 3593959807 2502326480 2502326480 326151275 3570297463
2525744318 12 2705709344 2293105904 63044568 4144173353 2525744318 2525744318 141680161 4061635107
2592330556 12 3105312559 2214035726 243203849 3998790955 2592330556 2592330556 431948861 3959216334
2610290479 9 2669374863 2125812933 225513085 4229654142 2610290479 2610290479 473294098 4216440507
2669374863 10 2712615025 2610290479 225513085 4229654142 2669374863 2669374863 473294098 4216440507
2705709344 13 2844041986 2525744318 63044568 4144173353 2705709344 2705709344 141680161 4061635107
2712615025 11 2830981072 2669374863 225513085 4229654142 2712615025 2712615025 473294098 4216440507
2778168728 15 2818832252 2502326480 28774375 3593959807 2778168728 2778168728 326151275 3570297463
2818832252 16 3023531799 2778168728 28774375 3593959807 2818832252 2818832252 326151275 3570297463
2830981072 12 2861376515 2712615025 225513085 4229654142 2830981072 2830981072 473294098 4216440507
2844041986 14 2939920218 2705709344 63044568 4144173353 2844041986 2844041986 141680161 4061635107
2861376515 13 3275293996 2830981072 225513085 4229654142 2861376515 2861376515 473294098 4216440507
2861911482 10 3342719438 2496054700 141047417 4268716378 2861911482 2861911482 662099130 3457053821
2939920218 15 3188005828 2844041986 63044568 4144173353 2939920218 2939920218 141680161 4061635107
3023531799 17 3126475872 2818832252 28774375 3593959807 3023531799 3023531799 326151275 3570297463
3105312559 13 3473924576 2592330556 243203849 3998790955 3105312559 3105312559 431948861 3959216334
3126475872 18 3198969145 3023531799 28774375 3593959807 3126475872 3126475872 326151275 3570297463
3188005828 16 3314983189 2939920218 63044568 4144173353 3188005828 3188005828 141680161 4061635107
3198969145 19 3521368277 3126475872 28774375 3593959807 3198969145 3198969145 326151275 3570297463
3275293996 14 3276123488 2861376515 225513085 4229654142 3275293996 3275293996 473294098 4216440507
3276123488 15 3542840110 3275293996 225513085 4229654142 3276123488 3276123488 473294098 4216440507
3314983189 17 3398507249 3188005828 63044568 4144173353 3314983189 3314983189 141680161 4061635107
3342719438 11 3373581039 2861911482 141047417 4268716378 3342719438 3342719438 662099130 3457053821
3373581039 12 3457053821 3342719438 141047417 4268716378 3373581039 3373581039 662099130 3457053821
3398507249 18 3455216719 3314983189 63044568 4144173353 3398507249 3398507249 141680161 4061635107
3455216719 19 3717551163 3398507249 63044568 4144173353 3455216719 3455216719 141680161 4061635107
3457053821 13 4268716378 3373581039 141047417 4268716378 3457053821 3457053821 662099130 3457053821
3473924576 14 3577318119 3105312559 243203849 3998790955 3473924576 3473924576 431948861 3959216334
3521368277 20 3566741189 3198969145 28774375 3593959807 3521368277 3521368277 326151275 3570297463
3542840110 16 3625286410 3276123488 225513085 4229654142 3542840110 3542840110 473294098 4216440507
3566741189 21 3570297463 3521368277 28774375 3593959807 3566741189 3566741189 326151275 3570297463
3570297463 22 3593959807 3566741189 28774375 3593959807 3570297463 3570297463 326151275 3570297463
3577318119 15 3759340273 3473924576 243203849 3998790955 3577318119 3577318119 431948861 3959216334
3593959807 23 NULL 3570297463 28774375 3593959807 3593959807 3593959807 326151275 NULL
3625286410 17 3766999078 3542840110 225513085 4229654142 3625286410 3625286410 473294098 4216440507
3717551163 20 4061635107 3455216719 63044568 4144173353 3717551163 3717551163 141680161 4061635107
3759340273 16 3862393166 3577318119 243203849 3998790955 3759340273 3759340273 431948861 3959216334
3766999078 18 4015442341 3625286410 225513085 4229654142 3766999078 3766999078 473294098 4216440507
3862393166 17 3959216334 3759340273 243203849 3998790955 3862393166 3862393166 431948861 3959216334
3959216334 18 3998790955 3862393166 243203849 3998790955 3959216334 3959216334 431948861 3959216334
3998790955 19 NULL 3959216334 243203849 3998790955 3998790955 3998790955 431948861 NULL
4015442341 19 4076864659 3766999078 225513085 4229654142 4015442341 4015442341 473294098 4216440507
4061635107 21 4144173353 3717551163 63044568 4144173353 4061635107 4061635107 141680161 4061635107
4076864659 20 4216440507 4015442341 225513085 4229654142 4076864659 4076864659 473294098 4216440507
4144173353 22 NULL 4061635107 63044568 4144173353 4144173353 4144173353 141680161 NULL
4216440507 21 4229654142 4076864659 225513085 4229654142 4216440507 4216440507 473294098 4216440507
4229654142 22 NULL 4216440507 225513085 4229654142 4229654142 4229654142 473294098 NULL
4268716378 14 NULL 3457053821 141047417 4268716378 4268716378 4268716378 662099130 NULL
