# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIII
select
  c9,
  cume_dist() OVER (PARTITION BY c2 ORDER BY c3) cume_dist_by_c3,
  rank() OVER (PARTITION BY c2 ORDER BY c3) rank_by_c3,
  dense_rank() OVER (PARTITION BY c2 ORDER BY c3) dense_rank_by_c3,
  percent_rank() OVER (PARTITION BY c2 ORDER BY c3) percent_rank_by_c3
FROM aggregate_test_100_by_sql
ORDER BY c9;
----
28774375 0.608695652174 14 14 0.590909090909
63044568 0.954545454545 21 19 0.952380952381
141047417 0.714285714286 10 10 0.692307692308
141680161 0.136363636364 3 3 0.095238095238
145294611 0.590909090909 13 12 0.571428571429
225513085 0.090909090909 2 2 0.047619047619
243203849 0.052631578947 1 1 0
326151275 0.652173913043 15 15 0.636363636364
431948861 0.473684210526 9 8 0.444444444444
466439833 0.130434782609 3 3 0.090909090909
473294098 0.772727272727 17 17 0.761904761905
520189543 0.318181818182 7 7 0.285714285714
538589788 0.782608695652 18 18 0.772727272727
557517119 0.304347826087 7 7 0.272727272727
559847112 0.105263157895 2 2 0.055555555556
598822671 0.409090909091 9 8 0.380952380952
662099130 0.857142857143 12 12 0.846153846154
754775609 0.578947368421 10 9 0.5
774637006 0.136363636364 3 3 0.095238095238
811650497 0.695652173913 16 16 0.681818181818
879082834 0.727272727273 16 16 0.714285714286
933879086 0.565217391304 13 13 0.545454545455
974297360 0.928571428571 13 13 0.923076923077
1000948272 0.863636363636 19 17 0.857142857143
1013876852 0.571428571429 8 8 0.538461538462
1088543984 0.736842105263 14 12 0.722222222222
1098639440 0.545454545455 12 11 0.52380952381
1157161427 0.090909090909 2 2 0.047619047619
1229567292 1 14 14 1
1243785310 0.086956521739 2 2 0.045454545455
1289293657 0.636363636364 14 13 0.619047619048
1362369177 0.631578947368 12 10 0.611111111111
1365198901 0.357142857143 5 5 0.307692307692
1454057357 0.227272727273 5 5 0.190476190476
1491205016 0.454545454545 10 9 0.428571428571
1534194097 0.95652173913 22 22 0.954545454545
1538863055 0.578947368421 10 9 0.5
1787652631 0.434782608696 10 10 0.409090909091
1824517658 0.157894736842 3 3 0.111111111111
1842680163 0.681818181818 15 15 0.666666666667
1865307672 0.739130434783 17 17 0.727272727273
1995343206 0.210526315789 4 4 0.166666666667
2013662838 0.727272727273 15 14 0.666666666667
2042457019 0.913043478261 21 21 0.909090909091
2093538928 0.789473684211 15 13 0.777777777778
2125812933 0.636363636364 14 14 0.619047619048
2214035726 0.421052631579 7 7 0.333333333333
2293105904 0.045454545455 1 1 0
2306130875 0.478260869565 11 11 0.454545454545
2307004493 0.785714285714 11 11 0.769230769231
2424630722 0.642857142857 9 9 0.615384615385
2496054700 0.071428571429 1 1 0
2502326480 0.347826086957 8 8 0.318181818182
2525744318 0.272727272727 5 5 0.190476190476
2592330556 1 19 17 1
2610290479 0.545454545455 12 12 0.52380952381
2669374863 0.409090909091 9 9 0.380952380952
2705709344 0.772727272727 17 15 0.761904761905
2712615025 0.590909090909 13 13 0.571428571429
2778168728 0.391304347826 9 9 0.363636363636
2818832252 0.217391304348 5 5 0.181818181818
2830981072 0.954545454545 21 21 0.952380952381
2844041986 0.272727272727 5 5 0.190476190476
2861376515 0.363636363636 8 8 0.333333333333
2861911482 0.214285714286 3 3 0.153846153846
2939920218 0.363636363636 8 7 0.333333333333
3023531799 0.04347826087 1 1 0
3105312559 0.684210526316 13 11 0.666666666667
3126475872 0.521739130435 12 12 0.5
3188005828 0.909090909091 20 18 0.904761904762
3198969145 0.826086956522 19 19 0.818181818182
3275293996 0.5 11 11 0.47619047619
3276123488 0.272727272727 6 6 0.238095238095
3314983189 0.727272727273 15 14 0.666666666667
3342719438 0.285714285714 4 4 0.230769230769
3373581039 0.5 7 7 0.461538461538
3398507249 0.5 11 10 0.47619047619
3455216719 0.818181818182 18 16 0.809523809524
3457053821 0.428571428571 6 6 0.384615384615
3473924576 0.842105263158 16 14 0.833333333333
3521368277 0.869565217391 20 20 0.863636363636
3542840110 0.181818181818 4 4 0.142857142857
3566741189 1 23 23 1
3570297463 0.260869565217 6 6 0.227272727273
3577318119 0.894736842105 17 15 0.888888888889
3593959807 0.173913043478 4 4 0.136363636364
3625286410 1 22 22 1
3717551163 0.318181818182 7 6 0.285714285714
3759340273 0.947368421053 18 16 0.944444444444
3766999078 0.909090909091 20 20 0.904761904762
3862393166 0.315789473684 6 6 0.277777777778
3959216334 0.263157894737 5 5 0.222222222222
3998790955 0.421052631579 7 7 0.333333333333
4015442341 0.863636363636 19 19 0.857142857143
4061635107 1 22 20 1
4076864659 0.454545454545 10 10 0.428571428571
4144173353 0.181818181818 4 4 0.142857142857
4216440507 0.045454545455 1 1 0
4229654142 0.818181818182 18 18 0.809523809524
4268716378 0.142857142857 2 2 0.076923076923
