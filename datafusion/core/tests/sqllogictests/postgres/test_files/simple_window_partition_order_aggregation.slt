# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

query IIIRIII
SELECT
  c9,
  row_number() OVER (PARTITION BY c2 ORDER BY c9) AS row_number,
  count(c3) OVER (PARTITION BY c2 ORDER BY c9) AS count_c3,
  avg(c3) OVER (PARTITION BY c2 ORDER BY c9) AS avg_c3_by_c2,
  sum(c3) OVER (PARTITION BY c2 ORDER BY c9) AS sum_c3_by_c2,
  max(c3) OVER (PARTITION BY c2 ORDER BY c9) AS max_c3_by_c2,
  min(c3) OVER (PARTITION BY c2 ORDER BY c9) AS min_c3_by_c2
FROM aggregate_test_100_by_sql
ORDER BY c9;
----
28774375 1 1 30 30 30 30
63044568 1 1 113 113 113 113
141047417 1 1 36 36 36 36
141680161 2 2 3.5 7 113 -106
145294611 3 3 17.333333333333 52 113 -106
225513085 1 1 -98 -98 -98 -98
243203849 1 1 -101 -101 -101 -101
326151275 2 2 38.5 77 47 30
431948861 2 2 -43.5 -87 14 -101
466439833 3 3 -8 -24 47 -101
473294098 2 2 -14 -28 70 -98
520189543 3 3 -17.333333333333 -52 70 -98
538589788 4 4 12.25 49 73 -101
557517119 5 5 -1.4 -7 73 -101
559847112 3 3 -60.666666666667 -182 14 -101
598822671 4 4 5.75 23 113 -106
662099130 2 2 50 100 64 36
754775609 4 4 -41.25 -165 17 -101
774637006 4 4 -34.25 -137 70 -98
811650497 6 6 8 48 73 -101
879082834 5 5 -16 -80 70 -98
933879086 7 7 9.285714285714 65 73 -101
974297360 3 3 56 168 68 36
1000948272 5 5 23.2 116 113 -106
1013876852 4 4 34.25 137 68 -31
1088543984 5 5 -18.4 -92 73 -101
1098639440 6 6 24.5 147 113 -106
1157161427 7 7 5.714285714286 40 113 -107
1229567292 5 5 51 255 118 -31
1243785310 8 8 -5.75 -46 73 -111
1289293657 8 8 11.125 89 113 -107
1362369177 6 6 -11.666666666667 -70 73 -101
1365198901 6 6 32.666666666667 196 118 -59
1454057357 6 6 -22.666666666667 -136 70 -98
1491205016 9 9 10 90 113 -107
1534194097 9 9 6.222222222222 56 102 -111
1538863055 7 7 -7.571428571429 -53 73 -101
1787652631 10 10 1.8 18 102 -111
1824517658 8 8 -16.125 -129 73 -101
1842680163 7 7 -11.714285714286 -82 70 -98
1865307672 11 11 7.545454545455 83 102 -111
1995343206 9 9 -22.333333333333 -201 73 -101
2013662838 10 10 14.2 142 113 -107
2042457019 12 12 15 180 102 -111
2093538928 10 10 -12.4 -124 77 -101
2125812933 8 8 -5.125 -41 70 -98
2214035726 11 11 -10.090909090909 -111 77 -101
2293105904 11 11 2.272727272727 25 113 -117
2306130875 13 13 14.076923076923 183 102 -111
2307004493 7 7 36.857142857143 258 118 -59
2424630722 8 8 31.625 253 118 -59
2496054700 9 9 16.888888888889 152 118 -101
2502326480 14 14 9.214285714286 129 102 -111
2525744318 12 12 -2.916666666667 -35 113 -117
2592330556 12 12 1 12 123 -101
2610290479 9 9 -0.555555555556 -5 70 -98
2669374863 10 10 -1 -10 70 -98
2705709344 13 13 2.153846153846 28 113 -117
2712615025 11 11 2.545454545455 28 70 -98
2778168728 15 15 5.066666666667 76 102 -111
2818832252 16 16 -0.1875 -3 102 -111
2830981072 12 12 12.333333333333 148 120 -98
2844041986 14 14 -2.285714285714 -32 113 -117
2861376515 13 13 10.769230769231 140 120 -98
2861911482 10 10 6.6 66 118 -101
2939920218 15 15 -5 -75 113 -117
3023531799 17 17 -7.058823529412 -120 102 -117
3105312559 13 13 6.384615384615 83 123 -101
3126475872 18 18 -6.388888888889 -115 102 -117
3188005828 16 16 1.375 22 113 -117
3198969145 19 19 -2.157894736842 -41 102 -117
3275293996 14 14 12.071428571429 169 120 -98
3276123488 15 15 9.6 144 120 -98
3314983189 17 17 4.352941176471 74 113 -117
3342719438 11 11 -1.454545454545 -16 118 -101
3373581039 12 12 -4.666666666667 -56 118 -101
3398507249 18 18 5.722222222222 103 113 -117
3455216719 19 19 9 171 113 -117
3457053821 13 13 -7.692307692308 -100 118 -101
3473924576 14 14 12.857142857143 180 123 -101
3521368277 20 20 2.75 55 102 -117
3542840110 16 16 4.5 72 120 -98
3566741189 21 21 8.47619047619 178 123 -117
3570297463 22 22 5.409090909091 119 123 -117
3577318119 15 15 18.933333333333 284 123 -101
3593959807 23 23 1.260869565217 29 123 -117
3625286410 17 17 11.588235294118 197 125 -98
3717551163 20 20 6.15 123 113 -117
3759340273 16 16 24.75 396 123 -101
3766999078 18 18 16.666666666667 300 125 -98
3862393166 17 17 23.176470588235 394 123 -101
3959216334 18 18 21.222222222222 382 123 -101
3998790955 19 19 20.789473684211 395 123 -101
4015442341 19 19 20.157894736842 383 125 -98
4061635107 21 21 11.666666666667 245 122 -117
4076864659 20 20 19.75 395 125 -98
4144173353 22 22 8.363636363636 184 122 -117
4216440507 21 21 14.095238095238 296 125 -99
4229654142 22 22 16.681818181818 367 125 -99
4268716378 14 14 -13.857142857143 -194 118 -101
